var numbers_regex=/^[0-9]+$/,alphanumeric_regex=/^[a-zA-Z0-9]+$/,alphabets_regex=/^[a-zA-Z]+$/,username_regex=/^[a-zA-Z]{1}(\.{0,1}[\w-])+$/,email_regex=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;function replace_username(a){$("#username").val(a);$("#username_status").html("");$("#username_suggestions").html("");$("#registerBox").css("height","580px")}function set_username_status(a){0===a?$("#username_taken").val("1"):$("#username_taken").val("0")}
function suggest_usernames(a){var b="",c="";set_username_status(a.available);0===a.available?(b='<span style="color: red;">Username is already in use.</span>',c+="<div>Suggested usernames:</div>",$.each(a.usernames,function(a,b){c+='<label class="radio"><input type="radio" name="username_suggest" id="username_suggest_'+a+'" value="'+b+'" onclick="replace_username(\''+b+"');\" />"+b+"</label>"})):b='<span style="color: green;">Username is available</span>';$("#username_status").html(b);$("#username_suggestions").html(c);
$("#username_loading").hide()}function is_username_available(a){a=$.ajax({url:"/sites/corporate/registration/check_username",cache:!1,async:!1,data:{checkonly:"1",username:a},dataType:"json"});a=JSON.parse(a.responseText).data;return parseInt(a.available,10)}
function validate_username_field(a,b){var c="";""==a?c+="Username is required.<br />":isNaN(a.substr(0,1))?6>a.length&&b?c+="Username must be between 6 and 20 characters long.<br />":20<a.length?c+="Username must be between 6 and 20 characters long.<br />":username_regex.test(a)||(c+="Username contains illegal characters.<br />"):c+="Username must start with a letter.<br />";return c}
function check_username_availability(a){var b=validate_username_field(a,1);$("#username_status, #username_suggestions, #error_username").html("");""!=b?$("#error_username").html(b):($("#username_loading").show(),$.ajax({url:"/sites/corporate/registration/check_username",data:{username:a},success:suggest_usernames,dataType:"json"}))}
function refresh_captcha(){$("#captcha_loading").show();$.ajax({url:"/sites/corporate/registration/refresh_captcha",dataType:"json",success:function(a){$("#session_code").val(a.captcha_session_code);$("#captcha_image").attr("src",a.captcha_image_path);$("#captcha_loading").hide()}});return!1}
function validate_resend_smscode_form(){var a=!1,b="",c="",b=$.trim($("#username").val()),d=$.trim($("#mobile").val()),b=validate_username_field(b,1);""!=b?($("#error_username").html(b),a=!0):$("#error_username").html("");""==d?c+="Mobile number is required<br />":numbers_regex.test(d)||(c+="Mobile number contains illegal characters<br />");""!=c?($("#error_mobile").html(c),a=!0):$("#error_mobile").html("");return a?!1:!0}
function validate_activate_form(){var a=!1,b="",c=$.trim($("#smscode").val());""==c?b+="SMS Code is required<br />":numbers_regex.test(c)||(b+="SMS Code contains illegal characters<br />");""!=b?($("#error_smscode").html(b),a=!0):$("#error_smscode").html("");return a?!1:!0}
function validate_auth_username_form(){var a=!1,b="",c="",d=$.trim($("#smscode").val()),c=$.trim($("#username").val()),c=validate_username_field(c,1);""!=c?($("#error_username").html(c),a=!0):$("#error_username").html("");""==d?b+="SMS Code is required<br />":numbers_regex.test(d)||(b+="SMS Code contains illegal characters<br />");""!=b?($("#error_smscode").html(b),a=!0):$("#error_smscode").html("");return a?!1:!0}
function validate_registration_form(a){var b=!1,c="",d="",f="";if(a)var g="";else var h="",i="",k="";var j=$.trim($("#username").val()),e=$.trim($("#password").val()),m=$.trim($('input[name="repassword"]').val());if(a)var n=$.trim($('input[name="email"]').val());else var l=$.trim($("#mobile").val()),o=$.trim($("#remobile").val()),c=parseInt($('select[name="dob-year"]').val(),10),p=parseInt($('select[name="dob-month"]').val(),10)-1,q=parseInt($('select[name="dob-day"]').val(),10),r=new Date(c,p,q);
var s=$.trim($("#captcha").val());$("#username_status").html("");c=validate_username_field(j,1);""==c&&(""!=j&&!is_username_available(j))&&(c+="Username is already in use<br />");""!=c&&(b=!0);$("#error_username").html(c);""==e?d+="Password is required.<br />":6>e.length?d+="Password must be at least 6 characters long.<br />":alphanumeric_regex.test(e)?alphabets_regex.test(e)||numbers_regex.test(e)?d+="Password must contain at least 1 letter and 1 number.<br />":j==e&&(d+="Password must NOT be similar to username.<br />"):
d+="Password contains illegal characters.<br />";""!=d&&(b=!0);$("#error_password").html(d);""==m?f+="Please re-enter your password.<br />":e!=m&&(f+="Password do not match.<br />");""!=f&&(b=!0);$("#error_repassword").html(f);if(a)""==n?g+="Sorry. You need to fill in a valid email address before continuing.<br />":email_regex.test(n)||(g+="Email address contains illegal characters.<br />"),""!=g&&(b=!0),$("#error_email").html(g);else{""==l?h+="Mobile number is required.<br />":numbers_regex.test(l)||
(h+="Mobile number contains illegal characters.<br />");""!=h&&(b=!0);$("#error_mobile").html(h);""==o?i+="Mobile number is required.<br />":l!=o&&(i+="Mobile number does not match.<br />");""!=i&&(b=!0);$("#error_remobile").html(i);if(q!=r.getDate()||p!=r.getMonth())k="Date of birth is invalid.";""!=k&&(b=!0);$("#error_dob").html(k)}""==s?($("#error_captcha").html("Security code is required.<br />"),b=!0):$("#error_captcha").html("");return!1==b}
$(".settings_form").ready(function(){$("#username").focus();$("#check_availability").click(function(a){a.preventDefault();username=$.trim($("#username").val());check_username_availability(username)});$(".refresh_captcha").click(refresh_captcha)});